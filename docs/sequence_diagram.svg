<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="681px" preserveAspectRatio="none" style="width:1247px;height:681px;background:#FFFFFF;" version="1.1" viewBox="0 0 1247 681" width="1247px" zoomAndPan="magnify"><title>goflowmeter - sequence diagram</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="260.9893" x="494.9534" y="27.9951">goflowmeter - sequence diagram</text><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="814.6216" x="427.2744" y="436.7891"/><g><title>Caller</title><rect fill="#000000" fill-opacity="0.00000" height="481.8594" width="8" x="24.2515" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="28" x2="28" y1="118.5938" y2="600.4531"/></g><g><title>ConvertToPacketInfo</title><rect fill="#000000" fill-opacity="0.00000" height="481.8594" width="8" x="217.8164" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="220.8667" x2="220.8667" y1="118.5938" y2="600.4531"/></g><g><title>ProcessPacketsWithKeys</title><rect fill="#000000" fill-opacity="0.00000" height="481.8594" width="8" x="526.9507" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="530.2744" x2="530.2744" y1="118.5938" y2="600.4531"/></g><g><title>..RawPacket</title><rect fill="#000000" fill-opacity="0.00000" height="481.8594" width="8" x="777.7944" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="780.9897" x2="780.9897" y1="118.5938" y2="600.4531"/></g><g><title>..PacketInfo</title><rect fill="#000000" fill-opacity="0.00000" height="481.8594" width="8" x="887.7734" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="891.5991" x2="891.5991" y1="118.5938" y2="600.4531"/></g><g><title>byFlow</title><rect fill="#000000" fill-opacity="0.00000" height="481.8594" width="8" x="978.5127" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="981.9478" x2="981.9478" y1="118.5938" y2="600.4531"/></g><g><title>compute.</title><rect fill="#000000" fill-opacity="0.00000" height="481.8594" width="8" x="1061.459" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1065.0776" x2="1065.0776" y1="118.5938" y2="600.4531"/></g><g><title>..FlowWithKey</title><rect fill="#000000" fill-opacity="0.00000" height="481.8594" width="8" x="1170.3682" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1173.8403" x2="1173.8403" y1="118.5938" y2="600.4531"/></g><g class="participant participant-head" data-participant="Caller"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5029" x="5" y="115.292">Caller</text><ellipse cx="28.2515" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28.2515,58.7969 L28.2515,85.7969 M15.2515,66.7969 L41.2515,66.7969 M28.2515,85.7969 L15.2515,100.7969 M28.2515,85.7969 L41.2515,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Caller"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5029" x="5" y="612.4482">Caller</text><ellipse cx="28.2515" cy="624.25" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28.2515,632.25 L28.2515,659.25 M15.2515,640.25 L41.2515,640.25 M28.2515,659.25 L15.2515,674.25 M28.2515,659.25 L41.2515,674.25" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Convert"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="159.8994" x="141.8667" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145.8994" x="148.8667" y="107.292">ConvertToPacketInfo</text></g><g class="participant participant-tail" data-participant="Convert"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="159.8994" x="141.8667" y="599.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145.8994" x="148.8667" y="619.4482">ConvertToPacketInfo</text></g><g class="participant participant-head" data-participant="API"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="187.3525" x="437.2744" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173.3525" x="444.2744" y="107.292">ProcessPacketsWithKeys</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="187.3525" x="437.2744" y="599.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173.3525" x="444.2744" y="619.4482">ProcessPacketsWithKeys</text></g><g class="participant participant-head" data-participant="Raw"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.6094" x="730.9897" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.6094" x="737.9897" y="107.292">[]RawPacket</text></g><g class="participant participant-tail" data-participant="Raw"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.6094" x="730.9897" y="599.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.6094" x="737.9897" y="619.4482">[]RawPacket</text></g><g class="participant participant-head" data-participant="Pkts"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98.3486" x="842.5991" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.3486" x="849.5991" y="107.292">[]PacketInfo</text></g><g class="participant participant-tail" data-participant="Pkts"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98.3486" x="842.5991" y="599.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.3486" x="849.5991" y="619.4482">[]PacketInfo</text></g><g class="participant participant-head" data-participant="ByFlow"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="63.1299" x="950.9478" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.1299" x="957.9478" y="107.292">byFlow</text></g><g class="participant participant-tail" data-participant="ByFlow"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="63.1299" x="950.9478" y="599.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.1299" x="957.9478" y="619.4482">byFlow</text></g><g class="participant participant-head" data-participant="Compute"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.7627" x="1024.0776" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.7627" x="1031.0776" y="107.292">compute*</text></g><g class="participant participant-tail" data-participant="Compute"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.7627" x="1024.0776" y="599.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.7627" x="1031.0776" y="619.4482">compute*</text></g><g class="participant participant-head" data-participant="Out"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.0557" x="1116.8403" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.0557" x="1123.8403" y="107.292">[]FlowWithKey</text></g><g class="participant participant-tail" data-participant="Out"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.0557" x="1116.8403" y="599.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.0557" x="1123.8403" y="619.4482">[]FlowWithKey</text></g><g class="message" data-participant-1="Caller" data-participant-2="Raw"><polygon fill="#181818" points="769.7944,145.7266,779.7944,149.7266,769.7944,153.7266,773.7944,149.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.2515" x2="775.7944" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.4204" x="35.2515" y="144.6606">from PCAP / source</text></g><g class="message" data-participant-1="Caller" data-participant-2="Convert"><polygon fill="#181818" points="209.8164,174.8594,219.8164,178.8594,209.8164,182.8594,213.8164,178.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.2515" x2="215.8164" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.5649" x="35.2515" y="173.7935">ConvertToPacketInfo(raw)</text></g><g class="message" data-participant-1="Convert" data-participant-2="Convert"><line style="stroke:#181818;stroke-width:1;" x1="221.8164" x2="263.8164" y1="207.9922" y2="207.9922"/><line style="stroke:#181818;stroke-width:1;" x1="263.8164" x2="263.8164" y1="207.9922" y2="220.9922"/><line style="stroke:#181818;stroke-width:1;" x1="222.8164" x2="263.8164" y1="220.9922" y2="220.9922"/><polygon fill="#181818" points="232.8164,216.9922,222.8164,220.9922,232.8164,224.9922,228.8164,220.9922" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.1343" x="228.8164" y="202.9263">group by canonical key, sort by time per flow</text></g><g class="message" data-participant-1="Convert" data-participant-2="Convert"><line style="stroke:#181818;stroke-width:1;" x1="221.8164" x2="263.8164" y1="250.125" y2="250.125"/><line style="stroke:#181818;stroke-width:1;" x1="263.8164" x2="263.8164" y1="250.125" y2="263.125"/><line style="stroke:#181818;stroke-width:1;" x1="222.8164" x2="263.8164" y1="263.125" y2="263.125"/><polygon fill="#181818" points="232.8164,259.125,222.8164,263.125,232.8164,267.125,228.8164,263.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261.79" x="228.8164" y="245.0591">assign Direction (first packet = forward)</text></g><g class="message" data-participant-1="Convert" data-participant-2="Pkts"><polygon fill="#181818" points="879.7734,288.2578,889.7734,292.2578,879.7734,296.2578,883.7734,292.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="221.8164" x2="885.7734" y1="292.2578" y2="292.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.354" x="228.8164" y="287.1919">normalize 5-tuple, one flow per connection</text></g><g class="message" data-participant-1="Convert" data-participant-2="Caller"><polygon fill="#181818" points="39.2515,317.3906,29.2515,321.3906,39.2515,325.3906,35.2515,321.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="33.2515" x2="220.8164" y1="321.3906" y2="321.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.3237" x="45.2515" y="316.3247">[]PacketInfo</text></g><g class="message" data-participant-1="Caller" data-participant-2="API"><polygon fill="#181818" points="518.9507,346.5234,528.9507,350.5234,518.9507,354.5234,522.9507,350.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.2515" x2="524.9507" y1="350.5234" y2="350.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.876" x="35.2515" y="345.4575">ProcessPacketsWithKeys(packets)</text></g><g class="message" data-participant-1="API" data-participant-2="API"><line style="stroke:#181818;stroke-width:1;" x1="530.9507" x2="572.9507" y1="379.6563" y2="379.6563"/><line style="stroke:#181818;stroke-width:1;" x1="572.9507" x2="572.9507" y1="379.6563" y2="392.6563"/><line style="stroke:#181818;stroke-width:1;" x1="531.9507" x2="572.9507" y1="392.6563" y2="392.6563"/><polygon fill="#181818" points="541.9507,388.6563,531.9507,392.6563,541.9507,396.6563,537.9507,392.6563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.8438" x="537.9507" y="374.5903">group by CanonicalFlowKey(p.Key())</text></g><g class="message" data-participant-1="API" data-participant-2="ByFlow"><polygon fill="#181818" points="970.5127,417.7891,980.5127,421.7891,970.5127,425.7891,974.5127,421.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="530.9507" x2="976.5127" y1="421.7891" y2="421.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.2407" x="537.9507" y="416.7231">map[FlowKey][]PacketInfo</text></g><path d="M427.2744,436.7891 L503.8984,436.7891 L503.8984,443.9219 L493.8984,453.9219 L427.2744,453.9219 L427.2744,436.7891" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="814.6216" x="427.2744" y="436.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="442.2744" y="449.856">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="90.9917" x="518.8984" y="448.9995">[for each flow]</text><g class="message" data-participant-1="API" data-participant-2="API"><line style="stroke:#181818;stroke-width:1;" x1="530.9507" x2="572.9507" y1="475.0547" y2="475.0547"/><line style="stroke:#181818;stroke-width:1;" x1="572.9507" x2="572.9507" y1="475.0547" y2="488.0547"/><line style="stroke:#181818;stroke-width:1;" x1="531.9507" x2="572.9507" y1="488.0547" y2="488.0547"/><polygon fill="#181818" points="541.9507,484.0547,531.9507,488.0547,541.9507,492.0547,537.9507,488.0547" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.3955" x="537.9507" y="469.9888">sort packets by timestamp</text></g><g class="message" data-participant-1="API" data-participant-2="Compute"><polygon fill="#181818" points="1053.459,513.1875,1063.459,517.1875,1053.459,521.1875,1057.459,517.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="530.9507" x2="1059.459" y1="517.1875" y2="517.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359.5884" x="537.9507" y="512.1216">fill features by calling computeBasic ... computeInitWin</text></g><g class="message" data-participant-1="API" data-participant-2="Out"><polygon fill="#181818" points="1162.3682,542.3203,1172.3682,546.3203,1162.3682,550.3203,1166.3682,546.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="530.9507" x2="1168.3682" y1="546.3203" y2="546.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="459.6973" x="537.9507" y="541.2544">append results with the latest calculated FlowWithKey{Key, Features}</text></g><g class="message" data-participant-1="API" data-participant-2="Caller"><polygon fill="#181818" points="39.2515,578.4531,29.2515,582.4531,39.2515,586.4531,35.2515,582.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="33.2515" x2="529.9507" y1="582.4531" y2="582.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.8374" x="45.2515" y="577.3872">[]FlowWithKey</text></g><!--SRC=[RP9DRzim38Rl_XL4JydGPATU2cn0cw90q4EDOK0FHG-iGZj2P56Jw1dPiFy-VJWV3d8nPF4XN-ebHOiXQBanF7Gav641WNxrP1N1HcFhiQigLC8ULcWC-SgX5wsqGojmisBxcxpyv1hLZcHj6xu1333UJ-7Qiw8G2XhUj6nVQ1yo_r2lf-pxnmyS2fc1-7S9N4ZMEmbJv7F_79-LWu_vE0qhxbmlz6LiEFzSQgIiiT6ClVPILSK8M7nFNS4zD9uxg5SFDNo5mBrNT8QCJaJiYbSpZyEyEY0JklNSE_ZSWqBBLYiqiAFzRHI8uNWjkYDmKIEDxde9346t5fwq9oMQBSmQxOE0o_hm3Hhs0_hDf8DaOyorx3iq-W_1tK9wP-WMs58MowgAhIrLJyb9lBpx7ix7S-vO77ICNj-4MMaipAj47U6Z4wk34sagCM7cbkaxF_9boZ6bG_S-GX-JJWopIyy6GhKjrW5CrBA_OoC7duDWvqxWk2jfyjeOQ0YbznJAi8pHjeLnjnunQ0NBvV9miRPQthGzrOeBbIRb7DaDn2AzYR93D0HaIs1GedYgglfqti3PGlvzIVlmFAh_gsA5OiHq3cSP_m40]--></g></svg>